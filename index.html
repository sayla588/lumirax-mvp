<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>Lumirax MVP</title>
<style>
    body { font-family: Arial, sans-serif; background:#0d0d0d; color:white; margin:0; }
    #app { max-width: 700px; margin: auto; padding: 20px; }
    h1 { text-align:center; }
    #messages { height: 480px; overflow-y: auto; border: 1px solid #444; padding: 15px; border-radius: 8px; margin-bottom: 12px; }
    .msg { margin: 12px 0; padding: 12px 15px; border-radius: 8px; max-width: 80%; line-height:1.5; }
    .user { background:#0059ff; margin-left:auto; }
    .bot { background:#262626; margin-right:auto; border:1px solid #444; }
    #input-area { display:flex; gap:10px; }
    #userInput { flex:1; padding:10px; border-radius:6px; border:none; }
    button { padding:10px 15px; background:#00b894; border:none; border-radius:6px; cursor:pointer; color:black; font-weight:bold; }
    button:hover { opacity:0.8; }
</style>
</head>
<body>
<div id="app">
    <h1>Lumirax — Web3 风险扫描 MVP</h1>
    <div id="messages"></div>
    <div id="input-area">
        <input id="userInput" type="text" placeholder="输入你的问题，例如：检测一个钱包风险">
        <button onclick="sendMessage()">发送</button>
    </div>
</div>

<script>
const API_KEY = "sk-1371851d7df348bd8e96c5f424975584";   // ⬅️ 换成你的 DeepSeek Key
const API_URL = "https://api.deepseek.com/v1/chat/completions";

let messages = [];

function addMessage(text, sender) {
    const div = document.createElement("div");
    div.className = `msg ${sender}`;
    div.textContent = text;
    document.getElementById("messages").appendChild(div);
    document.getElementById("messages").scrollTop = 99999;
}

async function sendMessage() {
    const input = document.getElementById("userInput");
    const content = input.value.trim();
    if (!content) return;

    addMessage(content, "user");
    input.value = "";

    // Loading动画文字
    let loadingMsg = document.createElement("div");
    loadingMsg.className = "msg bot";
    loadingMsg.textContent = "⏳ 正在分析...";
    document.getElementById("messages").appendChild(loadingMsg);
    document.getElementById("messages").scrollTop = 99999;

    messages.push({ role: "user", content });

    try {
        const res = await fetch(API_URL, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": `Bearer ${API_KEY}`,
            },
            body: JSON.stringify({
                model: "deepseek-chat",
                messages: messages
            })
        });

        const data = await res.json();

        loadingMsg.remove(); // 去掉加载提示

        if (data.error) {
            addMessage("❌ 错误: " + data.error.message, "bot");
            return;
        }

        const reply = data.choices[0].message.content;
        addMessage(reply, "bot");
        messages.push({ role: "assistant", content: reply });

    } catch (e) {
        loadingMsg.remove();
        addMessage("⚠️ 请求失败（可能是 KEY 错误 / 调用频率过高 / 网络问题）", "bot");
    }
}
</script>
</body>
</html>
