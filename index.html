<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LumiraX — AI Web3 Assistant</title>

<style>
  body {
    margin: 0;
    background: radial-gradient(circle at 50% 10%, #1a2639, #090e14);
    font-family: "Inter", sans-serif;
    color: #e7f1ff;
    display: flex;
    justify-content: center;
  }
  .wrap {
    width: 100%;
    max-width: 880px;
    margin-top: 32px;
    padding: 0 20px 60px;
  }
  .hero {
    display: flex;
    gap: 18px;
    background: rgba(255,255,255,0.05);
    padding: 20px;
    border-radius: 18px;
    backdrop-filter: blur(10px);
    align-items: center;
    border: 1px solid rgba(255,255,255,0.07);
  }
  .hero img {
    width: 92px;
    height: 92px;
    border-radius: 20px;
    object-fit: cover;
    border: 2px solid rgba(255,255,255,0.16);
  }
  .hero .info h1 {
    font-size: 28px;
    margin: 0;
  }
  .hero .info p {
    margin: 6px 0 0 0;
    font-size: 16px;
    opacity: 0.85;
  }
  #messages {
    margin-top: 26px;
    background: rgba(255,255,255,0.04);
    border-radius: 16px;
    padding: 20px;
    height: 450px;
    overflow-y: auto;
    border: 1px solid rgba(255,255,255,0.05);
  }
  .m {
    max-width: 78%;
    padding: 14px 18px;
    border-radius: 14px;
    margin: 12px 0;
    line-height: 1.55em;
    font-size: 15px;
  }
  .user {
    margin-left: auto;
    background: #005dff;
    color: #fff;
    border-bottom-right-radius: 2px;
  }
  .bot {
    margin-right: auto;
    background: rgba(255,255,255,0.09);
    border-bottom-left-radius: 2px;
  }
  #inputBox {
    display: flex;
    gap: 10px;
    margin-top: 18px;
  }
  #q {
    flex: 1;
    padding: 14px;
    border-radius: 12px;
    border: none;
    font-size: 15px;
    background: rgba(255,255,255,0.09);
    color: #e7f1ff;
    outline: none;
  }
  button {
    padding: 14px 20px;
    background: #00c8ff;
    border-radius: 12px;
    border: none;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
  }
  button:active { opacity: 0.75; }
</style>
</head>
<body>
<div class="wrap">

  <!-- Character AI 头像区 -->
  <div class="hero">
    <img src="https://i.ibb.co/JzjDHkP/ai-avatar.png" alt="Lumira Avatar">
    <div class="info">
      <h1>LumiraX AI</h1>
      <p>你的 Web3 安全助手 · 提供合约风险分析、项目真伪检查、钱包安全检测</p>
    </div>
  </div>

  <!-- 聊天区域 -->
  <div id="messages"></div>

  <!-- 输入框 -->
  <div id="inputBox">
    <input id="q" placeholder="输入你的问题，例如：帮我检查这个合约是否安全">
    <button id="send">发送</button>
  </div>

</div>

<script>
const messagesEl = document.getElementById("messages");
const q = document.getElementById("q");
const sendBtn = document.getElementById("send");

function append(text, cls){
  const d = document.createElement("div");
  d.className = "m " + cls;
  d.textContent = text;
  messagesEl.appendChild(d);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

// 请求 Vercel 后端代理 API
async function ask(prompt){
  const r = await fetch("/api/chat", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ message: text })

  });

  const j = await r.json();
  if (j.reply) return j.reply;
  return "⚠️ 请求失败，请稍后重试";
}

async function send(){
  const v = q.value.trim();
  if(!v) return;
  append(v,"user");
  q.value = "";
  append("思考中…","bot");
  const reply = await ask(v);
  const last = messagesEl.querySelector(".bot:last-child");
  if(last && last.textContent === "思考中…") last.remove();
  append(reply,"bot");
}

sendBtn.onclick = send;
q.addEventListener("keydown", e => { if(e.key === "Enter") send(); });

// 欢迎消息
append("你好，我是 LumiraX AI。\n你可以问我：\n• 分析智能合约风险\n• 检查Web3项目真伪\n• 检查钱包地址是否暴露风险\n随时向我提问！","bot");
</script>
</body>
</html>
